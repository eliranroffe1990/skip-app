<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="SKIPAPP">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#A8D5BA">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTIgMTkyIj48cmVjdCBmaWxsPSIjQThENUJBIiB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgcng9IjQwIi8+PGNpcmNsZSBjeD0iOTYiIGN5PSI5NiIgcj0iNjAiIGZpbGw9IiNGRkYiIG9wYWNpdHk9IjAuMyIvPjxwYXRoIGQ9Ik02MCA5NmwyMCAyMCA0MC00MCIgc3Ryb2tlPSIjRkZGIiBzdHJva2Utd2lkdGg9IjEwIiBmaWxsPSJub25lIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz48L3N2Zz4=">
  <title>SKIPAPP - ××©×—×§ ×”×—×™×¡×›×•×Ÿ ×”×—×›×</title>
  <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0; 
      -webkit-tap-highlight-color: transparent; 
    }
    
    html, body { 
      height: 100%; 
      overflow: hidden; 
    }
    
    body { 
      font-family: 'Assistant', 'Rubik', sans-serif; 
      background: linear-gradient(135deg, #A8D5BA 0%, #D4E9DF 100%); 
      min-height: 100vh; 
    }
    
    :root {
      --primary: #A8D5BA;
      --primary-dark: #7EBA9B;
      --secondary: #FFD9A0;
      --accent: #FFB88C;
      --bg: #FFFCF7;
      --text: #3D3D3D;
      --text-light: #757575;
      --success: #90D4A8;
      --danger: #FF9B9B;
      --card-bg: #FFFFFF;
    }
    
    .app { 
      width: 100%; 
      height: 100vh; 
      max-width: 500px; 
      margin: 0 auto; 
      background: var(--bg); 
      position: relative; 
      overflow: hidden; 
    }
    
    @media (min-width: 501px) {
      body { 
        display: flex; 
        justify-content: center; 
        align-items: center; 
        padding: 20px; 
      }
      .app { 
        height: 90vh; 
        max-height: 850px; 
        border-radius: 40px; 
        box-shadow: 0 30px 80px rgba(0,0,0,0.15); 
      }
    }
    
    .screen { 
      display: none; 
      width: 100%; 
      height: 100%; 
      flex-direction: column; 
      overflow: hidden; 
    }
    
    .screen.active { 
      display: flex; 
      animation: fadeIn 0.4s ease; 
    }
    
    @keyframes fadeIn { 
      from { opacity: 0; transform: translateY(10px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    
    .header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      padding: 20px;
      text-align: center;
      border-radius: 0 0 30px 30px;
      box-shadow: 0 4px 20px rgba(168, 213, 186, 0.3);
      position: relative;
    }
    
    .header h1 {
      font-size: 32px;
      font-weight: 700;
      letter-spacing: -0.5px;
      margin-bottom: 5px;
    }
    
    .header .subtitle {
      font-size: 15px;
      opacity: 0.9;
      font-weight: 400;
    }
    
    .play-icon {
      width: 120px;
      height: 120px;
      margin: 40px auto 30px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--success) 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 40px rgba(168, 213, 186, 0.4);
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .play-icon::before {
      content: '';
      width: 0;
      height: 0;
      border-top: 25px solid transparent;
      border-bottom: 25px solid transparent;
      border-right: 40px solid white;
      margin-right: -5px;
    }
    
    .content {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      -webkit-overflow-scrolling: touch;
    }
    
    .card {
      background: var(--card-bg);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 15px;
      box-shadow: 0 2px 15px rgba(0,0,0,0.06);
    }
    
    .btn {
      width: 100%;
      padding: 16px;
      border: none;
      border-radius: 16px;
      font-size: 17px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: inherit;
      letter-spacing: -0.3px;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
      box-shadow: 0 6px 20px rgba(168, 213, 186, 0.3);
    }
    
    .btn-primary:active {
      transform: translateY(2px);
    }
    
    .btn-secondary {
      background: linear-gradient(135deg, var(--secondary) 0%, var(--accent) 100%);
      color: var(--text);
      box-shadow: 0 6px 20px rgba(255, 217, 160, 0.3);
    }
    
    .btn-danger {
      background: linear-gradient(135deg, var(--danger) 0%, #FF8080 100%);
      color: white;
      box-shadow: 0 6px 20px rgba(255, 155, 155, 0.3);
    }
    
    input, select {
      width: 100%;
      padding: 15px;
      border: 2px solid #E8E8E8;
      border-radius: 12px;
      font-size: 16px;
      font-family: inherit;
      transition: all 0.3s ease;
      background: white;
    }
    
    input:focus, select:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(168, 213, 186, 0.1);
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 20px;
    }
    
    .stat-card {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 16px;
      text-align: center;
      box-shadow: 0 2px 15px rgba(0,0,0,0.06);
    }
    
    .stat-value {
      font-size: 28px;
      font-weight: 700;
      color: var(--primary-dark);
      margin-bottom: 5px;
    }
    
    .stat-label {
      font-size: 13px;
      color: var(--text-light);
      font-weight: 500;
    }
    
    .date-display {
      background: linear-gradient(135deg, #F5F5F5 0%, #FAFAFA 100%);
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      margin-bottom: 20px;
      border: 1px solid #E8E8E8;
    }
    
    .date-hebrew {
      font-size: 16px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 5px;
    }
    
    .date-gregorian {
      font-size: 14px;
      color: var(--text-light);
      font-weight: 500;
    }
    
    .skip-entry {
      background: white;
      padding: 18px;
      border-radius: 14px;
      margin-bottom: 12px;
      border-right: 4px solid var(--primary);
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .skip-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .skip-category {
      font-size: 15px;
      font-weight: 600;
      color: var(--text);
    }
    
    .skip-amount {
      font-size: 20px;
      font-weight: 700;
      color: var(--success);
    }
    
    .skip-date {
      font-size: 13px;
      color: var(--text-light);
      margin-top: 5px;
    }
    
    .skip-description {
      font-size: 14px;
      color: var(--text-light);
      margin-top: 8px;
      line-height: 1.5;
    }
    
    .form-group {
      margin-bottom: 18px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text);
      font-size: 15px;
    }
    
    .bottom-nav {
      background: white;
      padding: 12px 20px;
      display: flex;
      justify-content: space-around;
      border-top: 1px solid #E8E8E8;
      box-shadow: 0 -2px 20px rgba(0,0,0,0.05);
    }
    
    .nav-btn {
      background: none;
      border: none;
      padding: 10px 15px;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-light);
      cursor: pointer;
      transition: all 0.3s ease;
      border-radius: 10px;
      font-family: inherit;
    }
    
    .nav-btn.active {
      color: var(--primary-dark);
      background: rgba(168, 213, 186, 0.1);
    }
    
    .back-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255,255,255,0.3);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      transition: all 0.3s ease;
      z-index: 10;
    }
    
    .back-btn:active {
      transform: scale(0.9);
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-light);
    }
    
    .empty-icon {
      font-size: 60px;
      margin-bottom: 20px;
      opacity: 0.3;
    }
    
    .empty-text {
      font-size: 16px;
    }
    
    .success-msg {
      background: linear-gradient(135deg, var(--success) 0%, #7FC99C 100%);
      color: white;
      padding: 15px;
      border-radius: 12px;
      text-align: center;
      margin-bottom: 20px;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(144, 212, 168, 0.3);
    }
    
    .category-badge {
      display: inline-block;
      padding: 6px 12px;
      background: rgba(168, 213, 186, 0.15);
      color: var(--primary-dark);
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      margin-left: 8px;
    }
    
    .welcome-content {
      text-align: center;
      padding: 40px 30px;
    }
    
    .app-title {
      font-size: 48px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 15px;
      letter-spacing: -1px;
    }
    
    .app-tagline {
      font-size: 18px;
      color: var(--text-light);
      margin-bottom: 40px;
      font-weight: 500;
    }
    
    .feature-list {
      text-align: right;
      margin: 30px 0;
    }
    
    .feature-item {
      padding: 15px;
      margin-bottom: 10px;
      background: white;
      border-radius: 12px;
      display: flex;
      align-items: center;
      gap: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.04);
    }
    
    .feature-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--success) 100%);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      flex-shrink: 0;
    }
    
    .feature-text {
      font-size: 15px;
      font-weight: 500;
      color: var(--text);
      text-align: right;
    }
    
    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }
    
    .modal.active {
      display: flex;
    }
    
    .modal-content {
      background: white;
      border-radius: 20px;
      padding: 30px;
      max-width: 400px;
      width: 100%;
      text-align: center;
      animation: slideUp 0.3s ease;
    }
    
    @keyframes slideUp {
      from { transform: translateY(50px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .modal-title {
      font-size: 22px;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 15px;
    }
    
    .modal-text {
      font-size: 16px;
      color: var(--text-light);
      line-height: 1.6;
      margin-bottom: 25px;
    }
    
    .modal-buttons {
      display: flex;
      gap: 10px;
    }
    
    .modal-buttons .btn {
      flex: 1;
    }
    
    .user-greeting {
      font-size: 18px;
      font-weight: 600;
      color: white;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- Welcome Screen -->
    <div class="screen active" id="welcome">
      <div class="header">
        <h1>SKIPAPP</h1>
        <div class="subtitle">×“×œ×’ ×¢×œ ×”×”×•×¦××”, ×¦×‘×•×¨ ×œ×¢×ª×™×“</div>
      </div>
      
      <div class="content">
        <div class="welcome-content">
          <div class="play-icon"></div>
          
          <div class="app-title">SKIPAPP</div>
          <div class="app-tagline">××©×—×§ ×”×—×™×¡×›×•×Ÿ ×©×™×©× ×” ×œ×š ××ª ×”×—×™×™×</div>
          
          <div class="feature-list">
            <div class="feature-item">
              <div class="feature-icon">âœ“</div>
              <div class="feature-text">×ª×¢×“ ×›×œ ×¨×›×™×©×” ×©×•×•×™×ª×¨×ª ×¢×œ×™×”</div>
            </div>
            <div class="feature-item">
              <div class="feature-icon">ğŸ’°</div>
              <div class="feature-text">×¦×‘×•×¨ × ×§×•×“×•×ª ×•×¨××” ××ª ×”×—×™×¡×›×•×Ÿ ×©×œ×š</div>
            </div>
            <div class="feature-item">
              <div class="feature-icon">ğŸ“Š</div>
              <div class="feature-text">×¢×§×•×‘ ××—×¨×™ ×”×”×ª×§×“××•×ª ×©×œ×š</div>
            </div>
            <div class="feature-item">
              <div class="feature-icon">ğŸ¯</div>
              <div class="feature-text">×”×©×’ ××˜×¨×•×ª ×•×”×ª×¤×ª×—</div>
            </div>
          </div>
          
          <button class="btn btn-primary" onclick="checkRegistration()">×‘×•××• × ×ª×—×™×œ!</button>
        </div>
      </div>
    </div>

    <!-- Registration Screen -->
    <div class="screen" id="register">
      <div class="header">
        <button class="back-btn" onclick="showScreen('welcome')">â†</button>
        <h1>×”×¨×©××”</h1>
        <div class="subtitle">×‘×•××• × ×›×™×¨!</div>
      </div>
      
      <div class="content">
        <div class="card">
          <form id="registerForm" onsubmit="saveRegistration(event)">
            <div class="form-group">
              <label>×©× ×¤×¨×˜×™</label>
              <input type="text" id="firstName" placeholder="××™×š ×§×•×¨××™× ×œ×š?" required>
            </div>
            
            <div class="form-group">
              <label>×’×™×œ</label>
              <input type="number" id="age" placeholder="×›××” ××ª×” ×‘×Ÿ/×‘×ª?" required min="1" max="120">
            </div>
            
            <div class="form-group">
              <label>××˜×¨×ª ×—×™×¡×›×•×Ÿ (××•×¤×¦×™×•× ×œ×™)</label>
              <input type="text" id="goal" placeholder="×œ××” ××ª×” ×—×•×¡×š?">
            </div>
            
            <button type="submit" class="btn btn-primary">×”×ª×—×œ ×œ×—×¡×•×š! ğŸš€</button>
          </form>
        </div>
        
        <div class="card" style="margin-top: 15px; background: #F5F5F5;">
          <p style="font-size: 14px; color: var(--text-light); line-height: 1.6;">
            â„¹ï¸ ×”× ×ª×•× ×™× ×©×œ×š × ×©××¨×™× ×‘××›×©×™×¨ ×©×œ×š ×‘×œ×‘×“ ×•×œ× × ×©×œ×—×™× ×œ×©×•× ××§×•×.
            ××ª×” ×ª××™×“ ×™×›×•×œ ×œ××—×•×§ ××• ×œ××¤×¡ ××ª ×”× ×ª×•× ×™× ×‘×”×’×“×¨×•×ª.
          </p>
        </div>
      </div>
    </div>

    <!-- Home Screen -->
    <div class="screen" id="home">
      <div class="header">
        <h1>SKIPAPP</h1>
        <div class="subtitle">×©×œ×•×, <span id="userName">××©×ª××©</span>!</div>
      </div>
      
      <div class="content">
        <div class="date-display">
          <div class="date-hebrew" id="hebrewDate">×˜×•×¢×Ÿ ×ª××¨×™×š...</div>
          <div class="date-gregorian" id="gregorianDate">Loading...</div>
        </div>
        
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value" id="totalPoints">0</div>
            <div class="stat-label">× ×§×•×“×•×ª ×›×•×œ×œ</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="todaySkips">0</div>
            <div class="stat-label">×“×™×œ×•×’×™× ×”×™×•×</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="weekStreak">0</div>
            <div class="stat-label">×¨×¦×£ ×™××™×</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="totalSavings">â‚ª0</div>
            <div class="stat-label">×—×¡×›×•×Ÿ ×›×•×œ×œ</div>
          </div>
        </div>
        
        <button class="btn btn-primary" onclick="showScreen('addSkip')" style="margin-bottom: 15px;">
          + ×”×•×¡×£ ×“×™×œ×•×’ ×—×“×©
        </button>
        
        <div class="card">
          <h3 style="margin-bottom: 15px; color: var(--text); font-size: 18px;">×”×“×™×œ×•×’×™× ×”××—×¨×•× ×™×</h3>
          <div id="recentSkips">
            <div class="empty-state">
              <div class="empty-icon">ğŸ“</div>
              <div class="empty-text">×¢×“×™×™×Ÿ ××™×Ÿ ×“×™×œ×•×’×™×</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="bottom-nav">
        <button class="nav-btn active" onclick="showScreen('home')">ğŸ  ×‘×™×ª</button>
        <button class="nav-btn" onclick="showScreen('history')">ğŸ“Š ×”×™×¡×˜×•×¨×™×”</button>
        <button class="nav-btn" onclick="showScreen('stats')">ğŸ“ˆ ×¡×˜×˜×™×¡×˜×™×§×•×ª</button>
        <button class="nav-btn" onclick="showScreen('settings')">âš™ï¸ ×”×’×“×¨×•×ª</button>
      </div>
    </div>

    <!-- Add Skip Screen -->
    <div class="screen" id="addSkip">
      <div class="header">
        <button class="back-btn" onclick="confirmNavigation('home', 'addSkip')">â†</button>
        <h1>×“×™×œ×•×’ ×—×“×©</h1>
        <div class="subtitle">×ª×¢×“ ×¨×›×™×©×” ×©×“×™×œ×’×ª ×¢×œ×™×”</div>
      </div>
      
      <div class="content">
        <div class="date-display">
          <div class="date-hebrew" id="addSkipHebrewDate">×˜×•×¢×Ÿ ×ª××¨×™×š...</div>
          <div class="date-gregorian" id="addSkipGregorianDate">Loading...</div>
        </div>
        
        <form id="skipForm" onsubmit="addSkip(event)">
          <div class="form-group">
            <label>×§×˜×’×•×¨×™×”</label>
            <select id="category" required>
              <option value="">×‘×—×¨ ×§×˜×’×•×¨×™×”</option>
              <option value="××•×›×œ ×•××©×§××•×ª">ğŸ• ××•×›×œ ×•××©×§××•×ª</option>
              <option value="××•×¤× ×” ×•×‘×™×’×•×“">ğŸ‘• ××•×¤× ×” ×•×‘×™×’×•×“</option>
              <option value="×‘×™×“×•×¨">ğŸ¬ ×‘×™×“×•×¨</option>
              <option value="×˜×›× ×•×œ×•×’×™×”">ğŸ“± ×˜×›× ×•×œ×•×’×™×”</option>
              <option value="×™×•×¤×™ ×•×˜×™×¤×•×—">ğŸ’„ ×™×•×¤×™ ×•×˜×™×¤×•×—</option>
              <option value="×ª×—×‘×•×¨×”">ğŸš— ×ª×—×‘×•×¨×”</option>
              <option value="×× ×•×™×™×">ğŸ“º ×× ×•×™×™×</option>
              <option value="×§× ×™×•×ª ×“×—×£">ğŸ›ï¸ ×§× ×™×•×ª ×“×—×£</option>
              <option value="×—×‘×¨×ª×™">ğŸ‰ ×—×‘×¨×ª×™</option>
              <option value="××—×¨">ğŸ“¦ ××—×¨</option>
            </select>
          </div>
          
          <div class="form-group">
            <label>×¡×›×•× (â‚ª)</label>
            <input type="number" id="amount" placeholder="×›××” ×—×¡×›×ª?" required min="1" step="0.01">
          </div>
          
          <div class="form-group">
            <label>×ª×™××•×¨ (××•×¤×¦×™×•× ×œ×™)</label>
            <input type="text" id="description" placeholder="×¢×œ ××” ×•×™×ª×¨×ª?">
          </div>
          
          <button type="submit" class="btn btn-primary">×©××•×¨ ×“×™×œ×•×’</button>
        </form>
      </div>
    </div>

    <!-- History Screen -->
    <div class="screen" id="history">
      <div class="header">
        <h1>×”×™×¡×˜×•×¨×™×”</h1>
        <div class="subtitle">×›×œ ×”×“×™×œ×•×’×™× ×©×œ×š</div>
      </div>
      
      <div class="content">
        <div class="date-display">
          <div class="date-hebrew" id="historyHebrewDate">×˜×•×¢×Ÿ ×ª××¨×™×š...</div>
          <div class="date-gregorian" id="historyGregorianDate">Loading...</div>
        </div>
        
        <div id="allSkips">
          <div class="empty-state">
            <div class="empty-icon">ğŸ“</div>
            <div class="empty-text">×¢×“×™×™×Ÿ ××™×Ÿ ×“×™×œ×•×’×™×</div>
          </div>
        </div>
      </div>
      
      <div class="bottom-nav">
        <button class="nav-btn" onclick="showScreen('home')">ğŸ  ×‘×™×ª</button>
        <button class="nav-btn active" onclick="showScreen('history')">ğŸ“Š ×”×™×¡×˜×•×¨×™×”</button>
        <button class="nav-btn" onclick="showScreen('stats')">ğŸ“ˆ ×¡×˜×˜×™×¡×˜×™×§×•×ª</button>
        <button class="nav-btn" onclick="showScreen('settings')">âš™ï¸ ×”×’×“×¨×•×ª</button>
      </div>
    </div>

    <!-- Stats Screen -->
    <div class="screen" id="stats">
      <div class="header">
        <h1>×¡×˜×˜×™×¡×˜×™×§×•×ª</h1>
        <div class="subtitle">×”× ×ª×•× ×™× ×©×œ×š ×‘××‘×˜ ××—×“</div>
      </div>
      
      <div class="content">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-value" id="statsTotal">0</div>
            <div class="stat-label">×¡×”"×› ×“×™×œ×•×’×™×</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="statsWeek">0</div>
            <div class="stat-label">×”×©×‘×•×¢</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="statsMonth">0</div>
            <div class="stat-label">×”×—×•×“×©</div>
          </div>
          <div class="stat-card">
            <div class="stat-value" id="statsAvg">â‚ª0</div>
            <div class="stat-label">×××•×¦×¢ ×“×™×œ×•×’</div>
          </div>
        </div>
        
        <div class="card">
          <h3 style="margin-bottom: 15px; color: var(--text); font-size: 18px;">×§×˜×’×•×¨×™×•×ª ×¤×•×¤×•×œ×¨×™×•×ª</h3>
          <div id="topCategories">
            <div class="empty-state">
              <div class="empty-icon">ğŸ“Š</div>
              <div class="empty-text">××™×Ÿ ××¡×¤×™×§ × ×ª×•× ×™×</div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="bottom-nav">
        <button class="nav-btn" onclick="showScreen('home')">ğŸ  ×‘×™×ª</button>
        <button class="nav-btn" onclick="showScreen('history')">ğŸ“Š ×”×™×¡×˜×•×¨×™×”</button>
        <button class="nav-btn active" onclick="showScreen('stats')">ğŸ“ˆ ×¡×˜×˜×™×¡×˜×™×§×•×ª</button>
        <button class="nav-btn" onclick="showScreen('settings')">âš™ï¸ ×”×’×“×¨×•×ª</button>
      </div>
    </div>

    <!-- Settings Screen -->
    <div class="screen" id="settings">
      <div class="header">
        <h1>×”×’×“×¨×•×ª</h1>
        <div class="subtitle">×”×ª×× ××™×©×™×ª ××ª ×”×—×•×•×™×”</div>
      </div>
      
      <div class="content">
        <div class="card">
          <h3 style="margin-bottom: 15px; color: var(--text); font-size: 18px;">×¤×¨×•×¤×™×œ ×©×œ×™</h3>
          <div id="userProfile" style="color: var(--text-light); line-height: 1.8;">
            <p><strong>×©×:</strong> <span id="profileName">-</span></p>
            <p><strong>×’×™×œ:</strong> <span id="profileAge">-</span></p>
            <p><strong>××˜×¨×”:</strong> <span id="profileGoal">-</span></p>
          </div>
        </div>
        
        <div class="card">
          <h3 style="margin-bottom: 15px; color: var(--text); font-size: 18px;">××•×“×•×ª SKIPAPP</h3>
          <p style="color: var(--text-light); line-height: 1.6; margin-bottom: 10px;">
            SKIPAPP ×”×™× ××¤×œ×™×§×¦×™×” ×—×™× ×•×›×™×ª ×©××‘×•×¡×¡×ª ×¢×œ ××—×§×¨ ×‘×›×œ×›×œ×” ×”×ª× ×”×’×•×ª×™×ª. 
            ×”××¤×œ×™×§×¦×™×” ××œ××“×ª ××•×¨×™×™× ×•×ª ×¤×™× × ×¡×™×ª ×‘×××¦×¢×•×ª ×ª×™×¢×•×“ ×”×•×¦××•×ª ×©× ×× ×¢×•.
          </p>
          <p style="color: var(--text-light); line-height: 1.6;">
            ×’×¨×¡×”: 3.0<br>
            ×¤×•×ª×— ×¢×œ ×™×“×™: ×“"×¨ ××œ×™×¨×Ÿ<br>
            ××‘×•×¡×¡ ×¢×œ ××ª×•×“×•×œ×•×’×™×™×ª AST
          </p>
        </div>
        
        <div class="card">
          <h3 style="margin-bottom: 15px; color: var(--text); font-size: 18px;">×¤×¢×•×œ×•×ª</h3>
          <button class="btn btn-secondary" onclick="exportData()" style="margin-bottom: 10px;">
            ğŸ“¥ ×™×™×¦× × ×ª×•× ×™×
          </button>
          <button class="btn btn-danger" onclick="confirmReset()">
            ğŸ”„ ××¤×¡ ×”×›×œ ×•×”×¨×©× ××—×“×©
          </button>
        </div>
      </div>
      
      <div class="bottom-nav">
        <button class="nav-btn" onclick="showScreen('home')">ğŸ  ×‘×™×ª</button>
        <button class="nav-btn" onclick="showScreen('history')">ğŸ“Š ×”×™×¡×˜×•×¨×™×”</button>
        <button class="nav-btn" onclick="showScreen('stats')">ğŸ“ˆ ×¡×˜×˜×™×¡×˜×™×§×•×ª</button>
        <button class="nav-btn active" onclick="showScreen('settings')">âš™ï¸ ×”×’×“×¨×•×ª</button>
      </div>
    </div>
  </div>

  <!-- Modal for confirmations -->
  <div class="modal" id="confirmModal">
    <div class="modal-content">
      <div class="modal-title" id="modalTitle">×”×× ×œ×©××•×¨?</div>
      <div class="modal-text" id="modalText">×™×© ×œ×š ×©×™× ×•×™×™× ×©×œ× × ×©××¨×•. ×”×× ×œ×©××•×¨ ××•×ª×?</div>
      <div class="modal-buttons">
        <button class="btn btn-secondary" id="modalCancel">×‘×™×˜×•×œ</button>
        <button class="btn btn-primary" id="modalConfirm">××™×©×•×¨</button>
      </div>
    </div>
  </div>

  <script>
    // Hebrew calendar
    const hebrewMonths = ['×ª×©×¨×™', '×—×©×•×•×Ÿ', '×›×¡×œ×•', '×˜×‘×ª', '×©×‘×˜', '××“×¨', '× ×™×¡×Ÿ', '××™×™×¨', '×¡×™×•×•×Ÿ', '×ª××•×–', '××‘', '××œ×•×œ'];
    const hebrewDays = ['×¨××©×•×Ÿ', '×©× ×™', '×©×œ×™×©×™', '×¨×‘×™×¢×™', '×—××™×©×™', '×©×™×©×™', '×©×‘×ª'];
    
    function getHebrewDate(date = new Date()) {
      const dayOfWeek = hebrewDays[date.getDay()];
      const year = 5785;
      const month = hebrewMonths[date.getMonth() % 12];
      const day = date.getDate();
      return `×™×•× ${dayOfWeek}, ${day} ${month} ${year}`;
    }
    
    function getGregorianDate(date = new Date()) {
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      return date.toLocaleDateString('he-IL', options);
    }
    
    function updateDates() {
      const now = new Date();
      const hebrew = getHebrewDate(now);
      const gregorian = getGregorianDate(now);
      
      document.querySelectorAll('[id$="HebrewDate"]').forEach(el => el.textContent = hebrew);
      document.querySelectorAll('[id$="GregorianDate"]').forEach(el => el.textContent = gregorian);
    }
    
    // Data storage
    let userData = JSON.parse(localStorage.getItem('skipapp_user') || 'null');
    let skipsData = JSON.parse(localStorage.getItem('skipapp_data') || '[]');
    let formDirty = false;
    
    // Check registration
    function checkRegistration() {
      if (userData) {
        showScreen('home');
        updateUserGreeting();
      } else {
        showScreen('register');
      }
    }
    
    // Save registration
    function saveRegistration(event) {
      event.preventDefault();
      
      const firstName = document.getElementById('firstName').value;
      const age = document.getElementById('age').value;
      const goal = document.getElementById('goal').value;
      
      userData = {
        firstName,
        age: parseInt(age),
        goal: goal || '×œ×¢×ª×™×“ ×˜×•×‘ ×™×•×ª×¨',
        registeredAt: new Date().toISOString()
      };
      
      localStorage.setItem('skipapp_user', JSON.stringify(userData));
      
      showScreen('home');
      updateUserGreeting();
      
      // Welcome message
      const homeContent = document.querySelector('#home .content');
      const successMsg = document.createElement('div');
      successMsg.className = 'success-msg';
      successMsg.textContent = `×‘×¨×•×š ×”×‘× ${firstName}! ×‘×•××• × ×ª×—×™×œ ×œ×—×¡×•×š! ğŸ‰`;
      homeContent.insertBefore(successMsg, homeContent.firstChild);
      setTimeout(() => successMsg.remove(), 3000);
    }
    
    // Update user greeting
    function updateUserGreeting() {
      if (userData) {
        document.getElementById('userName').textContent = userData.firstName;
        document.getElementById('profileName').textContent = userData.firstName;
        document.getElementById('profileAge').textContent = userData.age;
        document.getElementById('profileGoal').textContent = userData.goal;
      }
    }
    
    // Track form changes
    document.addEventListener('DOMContentLoaded', () => {
      const skipForm = document.getElementById('skipForm');
      if (skipForm) {
        skipForm.addEventListener('input', () => formDirty = true);
      }
    });
    
    // Confirm navigation with unsaved changes
    function confirmNavigation(toScreen, fromScreen) {
      if (formDirty && fromScreen === 'addSkip') {
        showModal(
          '×©×™× ×•×™×™× ×œ× × ×©××¨×•',
          '×”×× ×œ×©××•×¨ ××ª ×”×“×™×œ×•×’ ×œ×¤× ×™ ×©×—×•×–×¨×™×?',
          () => {
            // Save
            document.getElementById('skipForm').requestSubmit();
          },
          () => {
            // Don't save
            formDirty = false;
            document.getElementById('skipForm').reset();
            showScreen(toScreen);
          },
          '×©××•×¨',
          '××œ ×ª×©××•×¨'
        );
      } else {
        showScreen(toScreen);
      }
    }
    
    // Show modal
    function showModal(title, text, onConfirm, onCancel, confirmText = '××™×©×•×¨', cancelText = '×‘×™×˜×•×œ') {
      document.getElementById('modalTitle').textContent = title;
      document.getElementById('modalText').textContent = text;
      document.getElementById('modalConfirm').textContent = confirmText;
      document.getElementById('modalCancel').textContent = cancelText;
      
      const modal = document.getElementById('confirmModal');
      modal.classList.add('active');
      
      document.getElementById('modalConfirm').onclick = () => {
        modal.classList.remove('active');
        if (onConfirm) onConfirm();
      };
      
      document.getElementById('modalCancel').onclick = () => {
        modal.classList.remove('active');
        if (onCancel) onCancel();
      };
      
      modal.onclick = (e) => {
        if (e.target === modal) {
          modal.classList.remove('active');
          if (onCancel) onCancel();
        }
      };
    }
    
    // Show screen
    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(screenId).classList.add('active');
      document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
      
      updateDates();
      
      if (screenId === 'home') {
        loadHomeData();
      } else if (screenId === 'history') {
        loadHistory();
      } else if (screenId === 'stats') {
        loadStats();
      } else if (screenId === 'settings') {
        updateUserGreeting();
      }
    }
    
    // Add skip
    function addSkip(event) {
      event.preventDefault();
      
      const category = document.getElementById('category').value;
      const amount = parseFloat(document.getElementById('amount').value);
      const description = document.getElementById('description').value;
      
      const skip = {
        id: Date.now(),
        category,
        amount,
        description,
        date: new Date().toISOString(),
        hebrewDate: getHebrewDate(),
        gregorianDate: getGregorianDate(),
        points: Math.round(amount * 0.5)
      };
      
      skipsData.unshift(skip);
      localStorage.setItem('skipapp_data', JSON.stringify(skipsData));
      
      formDirty = false;
      document.getElementById('skipForm').reset();
      
      showScreen('home');
      
      const homeContent = document.querySelector('#home .content');
      const successMsg = document.createElement('div');
      successMsg.className = 'success-msg';
      successMsg.textContent = `×›×œ ×”×›×‘×•×“! ×”×¨×•×•×—×ª ${skip.points} × ×§×•×“×•×ª! ğŸ‰`;
      homeContent.insertBefore(successMsg, homeContent.firstChild);
      
      setTimeout(() => successMsg.remove(), 3000);
    }
    
    // Load home data
    function loadHomeData() {
      const totalPoints = skipsData.reduce((sum, skip) => sum + skip.points, 0);
      const today = new Date().toDateString();
      const todaySkips = skipsData.filter(skip => new Date(skip.date).toDateString() === today).length;
      const totalSavings = skipsData.reduce((sum, skip) => sum + skip.amount, 0);
      const weekStreak = calculateStreak();
      
      document.getElementById('totalPoints').textContent = totalPoints.toLocaleString();
      document.getElementById('todaySkips').textContent = todaySkips;
      document.getElementById('weekStreak').textContent = weekStreak;
      document.getElementById('totalSavings').textContent = `â‚ª${totalSavings.toLocaleString()}`;
      
      const recentSkipsContainer = document.getElementById('recentSkips');
      const recentSkips = skipsData.slice(0, 5);
      
      if (recentSkips.length === 0) {
        recentSkipsContainer.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">ğŸ“</div>
            <div class="empty-text">×¢×“×™×™×Ÿ ××™×Ÿ ×“×™×œ×•×’×™×</div>
          </div>
        `;
      } else {
        recentSkipsContainer.innerHTML = recentSkips.map(skip => `
          <div class="skip-entry">
            <div class="skip-header">
              <div class="skip-category">${skip.category}</div>
              <div class="skip-amount">â‚ª${skip.amount.toLocaleString()}</div>
            </div>
            <div class="skip-date">
              <div>${skip.hebrewDate}</div>
              <div style="font-size: 11px; margin-top: 2px;">${skip.gregorianDate}</div>
            </div>
            ${skip.description ? `<div class="skip-description">${skip.description}</div>` : ''}
          </div>
        `).join('');
      }
    }
    
    // Calculate streak
    function calculateStreak() {
      if (skipsData.length === 0) return 0;
      
      let streak = 0;
      let currentDate = new Date();
      currentDate.setHours(0, 0, 0, 0);
      
      for (let i = 0; i < 30; i++) {
        const dateStr = currentDate.toDateString();
        const hasSkipOnDate = skipsData.some(skip => 
          new Date(skip.date).toDateString() === dateStr
        );
        
        if (hasSkipOnDate) {
          streak++;
        } else if (i > 0) {
          break;
        }
        
        currentDate.setDate(currentDate.getDate() - 1);
      }
      
      return streak;
    }
    
    // Load history
    function loadHistory() {
      const allSkipsContainer = document.getElementById('allSkips');
      
      if (skipsData.length === 0) {
        allSkipsContainer.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">ğŸ“</div>
            <div class="empty-text">×¢×“×™×™×Ÿ ××™×Ÿ ×“×™×œ×•×’×™×</div>
          </div>
        `;
      } else {
        allSkipsContainer.innerHTML = skipsData.map(skip => `
          <div class="skip-entry">
            <div class="skip-header">
              <div class="skip-category">${skip.category}</div>
              <div class="skip-amount">â‚ª${skip.amount.toLocaleString()}</div>
            </div>
            <div class="skip-date">
              <div>${skip.hebrewDate}</div>
              <div style="font-size: 11px; margin-top: 2px;">${skip.gregorianDate}</div>
            </div>
            ${skip.description ? `<div class="skip-description">${skip.description}</div>` : ''}
            <div style="margin-top: 10px;">
              <span class="category-badge">+${skip.points} × ×§×•×“×•×ª</span>
            </div>
          </div>
        `).join('');
      }
    }
    
    // Load stats
    function loadStats() {
      const now = new Date();
      const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
      const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
      
      const statsTotal = skipsData.length;
      const statsWeek = skipsData.filter(skip => new Date(skip.date) >= weekAgo).length;
      const statsMonth = skipsData.filter(skip => new Date(skip.date) >= monthAgo).length;
      const statsAvg = skipsData.length > 0 
        ? Math.round(skipsData.reduce((sum, skip) => sum + skip.amount, 0) / skipsData.length)
        : 0;
      
      document.getElementById('statsTotal').textContent = statsTotal;
      document.getElementById('statsWeek').textContent = statsWeek;
      document.getElementById('statsMonth').textContent = statsMonth;
      document.getElementById('statsAvg').textContent = `â‚ª${statsAvg.toLocaleString()}`;
      
      const categoryCount = {};
      skipsData.forEach(skip => {
        categoryCount[skip.category] = (categoryCount[skip.category] || 0) + 1;
      });
      
      const topCategories = Object.entries(categoryCount)
        .sort((a, b) => b[1] - a[1])
        .slice(0, 5);
      
      const topCategoriesContainer = document.getElementById('topCategories');
      
      if (topCategories.length === 0) {
        topCategoriesContainer.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">ğŸ“Š</div>
            <div class="empty-text">××™×Ÿ ××¡×¤×™×§ × ×ª×•× ×™×</div>
          </div>
        `;
      } else {
        topCategoriesContainer.innerHTML = topCategories.map(([category, count]) => `
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #f0f0f0;">
            <div style="font-size: 15px; color: var(--text);">${category}</div>
            <div style="font-size: 18px; font-weight: 700; color: var(--primary-dark);">${count}</div>
          </div>
        `).join('');
      }
    }
    
    // Export data
    function exportData() {
      const exportObj = {
        user: userData,
        skips: skipsData,
        exportDate: new Date().toISOString()
      };
      const dataStr = JSON.stringify(exportObj, null, 2);
      const dataBlob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(dataBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `skipapp-${userData?.firstName || 'user'}-${new Date().toISOString().split('T')[0]}.json`;
      link.click();
      URL.revokeObjectURL(url);
    }
    
    // Confirm reset
    function confirmReset() {
      showModal(
        '××™×¤×•×¡ ××œ×',
        '×”×× ××ª×” ×‘×˜×•×—? ×¤×¢×•×œ×” ×–×• ×ª××—×§ ××ª ×›×œ ×”× ×ª×•× ×™× ×©×œ×š ×•×ª×—×–×™×¨ ××•×ª×š ×œ××¡×š ×”×”×¨×©××”.',
        () => resetAll(),
        null,
        '××¤×¡ ×”×›×œ',
        '×‘×™×˜×•×œ'
      );
    }
    
    // Reset all
    function resetAll() {
      localStorage.removeItem('skipapp_user');
      localStorage.removeItem('skipapp_data');
      userData = null;
      skipsData = [];
      showScreen('welcome');
    }
    
    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      updateDates();
      if (userData) {
        updateUserGreeting();
      }
      setInterval(updateDates, 60000);
    });
    
    // Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch(() => {});
    }
  </script>
</body>
</html>
