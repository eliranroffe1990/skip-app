<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SKIPAPP v5.0 - Analytics Edition</title>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- Theme Color -->
  <meta name="theme-color" content="#A8D5BA">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="SKIPAPP">
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics-compat.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Assistant', sans-serif;
      background: linear-gradient(135deg, #FFFCF7 0%, #F8F4EF 100%);
      min-height: 100vh;
      direction: rtl;
    }
    
    .container {
      max-width: 428px;
      margin: 0 auto;
      background: white;
      min-height: 100vh;
      box-shadow: 0 0 40px rgba(0,0,0,0.1);
      position: relative;
    }
    
    .screen {
      display: none;
      padding: 20px;
      min-height: 100vh;
    }
    
    .screen.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Header */
    .header {
      background: linear-gradient(135deg, #A8D5BA 0%, #7EBA9B 100%);
      color: white;
      padding: 20px;
      border-radius: 0 0 20px 20px;
      margin: -20px -20px 20px -20px;
      position: relative;
    }
    
    .header h1 {
      font-size: 28px;
      font-weight: 800;
      margin-bottom: 5px;
    }
    
    .header p {
      font-size: 14px;
      opacity: 0.9;
    }
    
    .back-button, .home-button {
      position: absolute;
      top: 20px;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }
    
    .back-button {
      left: 20px;
    }
    
    .home-button {
      right: 20px;
    }
    
    .back-button:hover, .home-button:hover {
      background: rgba(255,255,255,0.3);
      transform: scale(1.1);
    }
    
    /* Form Elements */
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: #3D3D3D;
      font-size: 16px;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 15px;
      border: 2px solid #E8E8E8;
      border-radius: 12px;
      font-size: 16px;
      font-family: 'Assistant', sans-serif;
      transition: all 0.3s;
      background: white;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #A8D5BA;
      box-shadow: 0 0 0 3px rgba(168, 213, 186, 0.1);
    }
    
    /* Gender Radio Buttons */
    .gender-options {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }
    
    .gender-option {
      flex: 1;
      position: relative;
    }
    
    .gender-option input[type="radio"] {
      position: absolute;
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .gender-label {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px 10px;
      border: 2px solid #E8E8E8;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      background: white;
      min-height: 100px;
    }
    
    .gender-label .emoji {
      font-size: 32px;
      margin-bottom: 8px;
    }
    
    .gender-label .text {
      font-size: 14px;
      font-weight: 600;
      color: #757575;
    }
    
    .gender-option input[type="radio"]:checked + .gender-label {
      border-color: #A8D5BA;
      background: rgba(168, 213, 186, 0.1);
    }
    
    .gender-option input[type="radio"]:checked + .gender-label .text {
      color: #7EBA9B;
    }
    
    /* Buttons */
    .btn {
      width: 100%;
      padding: 18px;
      border: none;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 700;
      cursor: pointer;
      font-family: 'Assistant', sans-serif;
      transition: all 0.3s;
      margin-top: 10px;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #A8D5BA 0%, #7EBA9B 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(168, 213, 186, 0.3);
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(168, 213, 186, 0.4);
    }
    
    .btn-secondary {
      background: white;
      color: #7EBA9B;
      border: 2px solid #A8D5BA;
    }
    
    .btn-secondary:hover {
      background: rgba(168, 213, 186, 0.1);
    }
    
    /* Cards */
    .card {
      background: white;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 15px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      border: 1px solid #F0F0F0;
    }
    
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .card-title {
      font-size: 18px;
      font-weight: 700;
      color: #3D3D3D;
    }
    
    .card-amount {
      font-size: 24px;
      font-weight: 800;
      color: #7EBA9B;
    }
    
    .card-details {
      display: flex;
      gap: 15px;
      font-size: 14px;
      color: #757575;
    }
    
    .card-detail {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .stat-card {
      background: linear-gradient(135deg, #A8D5BA 0%, #7EBA9B 100%);
      color: white;
      padding: 20px;
      border-radius: 16px;
      text-align: center;
    }
    
    .stat-value {
      font-size: 32px;
      font-weight: 800;
      margin-bottom: 5px;
    }
    
    .stat-label {
      font-size: 14px;
      opacity: 0.9;
    }
    
    /* Purchase List */
    .purchase-list {
      max-height: 400px;
      overflow-y: auto;
      margin-bottom: 20px;
    }
    
    .purchase-item {
      background: #FFFCF7;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid #F0F0F0;
    }
    
    .purchase-info {
      flex: 1;
    }
    
    .purchase-name {
      font-weight: 600;
      color: #3D3D3D;
      margin-bottom: 5px;
    }
    
    .purchase-time {
      font-size: 12px;
      color: #757575;
    }
    
    .purchase-amount {
      font-size: 20px;
      font-weight: 700;
      color: #FF6B6B;
    }
    
    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 40px 20px;
      color: #757575;
    }
    
    .empty-state-icon {
      font-size: 64px;
      margin-bottom: 15px;
      opacity: 0.5;
    }
    
    /* Comparison Card */
    .comparison-card {
      background: linear-gradient(135deg, #FFD9A0 0%, #FFB88C 100%);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 20px;
      color: white;
    }
    
    .comparison-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 15px;
    }
    
    .comparison-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      font-size: 16px;
    }
    
    .comparison-label {
      opacity: 0.9;
    }
    
    .comparison-value {
      font-weight: 700;
      font-size: 20px;
    }
    
    .comparison-footer {
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid rgba(255,255,255,0.3);
      font-size: 14px;
      text-align: center;
    }
    
    /* Analytics Badge */
    .analytics-badge {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: #4CAF50;
      color: white;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      box-shadow: 0 2px 10px rgba(76, 175, 80, 0.3);
      z-index: 1000;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    /* Language Toggle */
    .lang-toggle {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .lang-btn {
      flex: 1;
      padding: 12px;
      border: 2px solid #E8E8E8;
      background: white;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s;
    }
    
    .lang-btn.active {
      background: #A8D5BA;
      color: white;
      border-color: #A8D5BA;
    }
    
    /* Responsive */
    @media (max-width: 428px) {
      .container {
        max-width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Analytics Badge -->
    <div class="analytics-badge" id="analyticsBadge">
      ğŸ“Š Analytics Active
    </div>
    
    <!-- Screen 1: Welcome -->
    <div class="screen active" id="welcomeScreen">
      <div class="header">
        <h1>×‘×¨×•×›×™× ×”×‘××™× ×œ-SKIPAPP</h1>
        <p>×“×œ×’ ×¢×œ ×”×”×•×¦××”, ×¦×‘×•×¨ ×œ×¢×ª×™×“ ğŸ’°</p>
      </div>
      
      <div style="text-align: center; margin: 60px 0;">
        <div style="width: 150px; height: 150px; background: linear-gradient(135deg, #A8D5BA 0%, #7EBA9B 100%); border-radius: 50%; margin: 0 auto 30px; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 40px rgba(168, 213, 186, 0.3);">
          <div style="font-size: 80px; color: white;">âœ“</div>
        </div>
        <h2 style="font-size: 24px; margin-bottom: 15px; color: #3D3D3D;">×”×—×™×¡×›×•×Ÿ ×©××©× ×” ×—×™×™×</h2>
        <p style="color: #757575; font-size: 16px; margin-bottom: 40px;">×¢×§×•×‘ ××—×¨×™ ×”×“×™×œ×•×’×™× ×©×œ×š ×•×¨××”<br>××™×š ×”×›×¡×£ ×”×§×˜×Ÿ ×”×•×¤×š ×œ×’×“×•×œ</p>
      </div>
      
      <button class="btn btn-primary" onclick="app.showScreen('registerScreen')">
        ×”×ª×—×œ ×¢×›×©×™×• ğŸš€
      </button>
    </div>
    
    <!-- Screen 2: Register -->
    <div class="screen" id="registerScreen">
      <div class="header">
        <button class="back-button" onclick="app.showScreen('welcomeScreen')">â†</button>
        <h1>×”×¨×©××”</h1>
        <p>×‘×•××• × ×›×™×¨!</p>
      </div>
      
      <!-- Language Toggle -->
      <div class="lang-toggle">
        <button class="lang-btn active" onclick="app.setLanguage('he')">ğŸ‡®ğŸ‡± ×¢×‘×¨×™×ª</button>
        <button class="lang-btn" onclick="app.setLanguage('en')">ğŸ‡¬ğŸ‡§ English</button>
      </div>
      
      <form onsubmit="app.register(event)">
        <div class="form-group">
          <label>××™×š ×§×•×¨××™× ×œ×š?</label>
          <input type="text" id="userName" placeholder="×©× ××œ×" required>
        </div>
        
        <div class="form-group">
          <label>×›××” ××ª×” ×‘×Ÿ/×‘×ª?</label>
          <input type="number" id="userAge" placeholder="×’×™×œ" min="13" max="120" required>
        </div>
        
        <div class="form-group">
          <label>××’×“×¨</label>
          <div class="gender-options">
            <div class="gender-option">
              <input type="radio" id="genderMale" name="gender" value="male" required>
              <label for="genderMale" class="gender-label">
                <span class="emoji">ğŸ‘¨</span>
                <span class="text">×–×›×¨</span>
              </label>
            </div>
            <div class="gender-option">
              <input type="radio" id="genderFemale" name="gender" value="female">
              <label for="genderFemale" class="gender-label">
                <span class="emoji">ğŸ‘©</span>
                <span class="text">× ×§×‘×”</span>
              </label>
            </div>
            <div class="gender-option">
              <input type="radio" id="genderOther" name="gender" value="other">
              <label for="genderOther" class="gender-label">
                <span class="emoji">ğŸ§‘</span>
                <span class="text">××—×¨</span>
              </label>
            </div>
          </div>
        </div>
        
        <div class="form-group">
          <label>×œ××” ××ª×” ×—×•×¡×š?</label>
          <input type="text" id="userGoal" placeholder='×œ××©×œ: "×˜×™×•×œ ×‘×—×•×´×œ" ××• "××›×•× ×™×ª"' required>
        </div>
        
        <button type="submit" class="btn btn-primary">
          ×”××©×š â†’
        </button>
      </form>
    </div>
    
    <!-- Screen 3: Home Dashboard -->
    <div class="screen" id="homeScreen">
      <div class="header">
        <h1 id="welcomeMessage">×©×œ×•×, ××©×ª××©!</h1>
        <p>×”××¡×¢ ×©×œ×š ×œ×—×™×¡×›×•×Ÿ ×—×›×</p>
      </div>
      
      <!-- Stats -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value" id="totalSkips">0</div>
          <div class="stat-label">×“×™×œ×•×’×™×</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="totalSavings">â‚ª0</div>
          <div class="stat-label">×—×¡×›×•×Ÿ</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="totalPoints">0</div>
          <div class="stat-label">× ×§×•×“×•×ª</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="totalPurchases">0</div>
          <div class="stat-label">×§× ×™×•×ª ×‘×¤×•×¢×œ</div>
        </div>
      </div>
      
      <!-- Quick Actions -->
      <h3 style="margin: 20px 0 15px; font-size: 18px; color: #3D3D3D;">×¤×¢×•×œ×•×ª ××”×™×¨×•×ª</h3>
      
      <button class="btn btn-primary" onclick="app.showScreen('addSkipScreen')">
        ğŸ’¸ ×ª×¢×“ ×“×™×œ×•×’
      </button>
      
      <button class="btn btn-secondary" onclick="app.showScreen('addPurchaseScreen')">
        ğŸ›’ ×ª×¢×“ ×§× ×™×™×” ×‘×¤×•×¢×œ
      </button>
      
      <button class="btn btn-secondary" onclick="app.showScreen('investmentScreen')">
        ğŸ’¡ ×œ××“ ×œ×”×©×§×™×¢
      </button>
      
      <button class="btn btn-secondary" onclick="app.showScreen('historyScreen')">
        ğŸ“Š ×”×™×¡×˜×•×¨×™×” ×•××¢×§×‘
      </button>
    </div>
    
    <!-- Screen 4: Add Skip -->
    <div class="screen" id="addSkipScreen">
      <div class="header">
        <button class="back-button" onclick="app.showScreen('homeScreen')">â†</button>
        <button class="home-button" onclick="app.showScreen('homeScreen')">ğŸ </button>
        <h1>×ª×¢×“ ×“×™×œ×•×’</h1>
        <p>×¢×œ ××” ×“×™×œ×’×ª?</p>
      </div>
      
      <form onsubmit="app.addSkip(event)">
        <div class="form-group">
          <label>×¢×œ ××” ×“×™×œ×’×ª?</label>
          <input type="text" id="skipItem" placeholder='×œ××©×œ: "×§×¤×”", "××¨×•×—×ª ×¦×”×¨×™×™×"' required>
        </div>
        
        <div class="form-group">
          <label>×›××” ×–×” ×”×™×” ×¢×•×œ×”?</label>
          <input type="number" id="skipAmount" placeholder="×¡×›×•× ×‘×©×´×—" min="1" step="0.01" required>
        </div>
        
        <div class="form-group">
          <label>×§×˜×’×•×¨×™×”</label>
          <select id="skipCategory" required>
            <option value="">×‘×—×¨ ×§×˜×’×•×¨×™×”</option>
            <option value="food">××•×›×œ ×•×©×ª×™×™×”</option>
            <option value="clothes">×‘×’×“×™×</option>
            <option value="entertainment">×‘×™×œ×•×™×™×</option>
            <option value="transport">×ª×—×‘×•×¨×”</option>
            <option value="tech">×˜×›× ×•×œ×•×’×™×”</option>
            <option value="other">××—×¨</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>×”×¢×¨×•×ª (××•×¤×¦×™×•× ×œ×™)</label>
          <textarea id="skipNotes" rows="3" placeholder="×œ××” ×”×—×œ×˜×ª ×œ×“×œ×’?"></textarea>
        </div>
        
        <button type="submit" class="btn btn-primary">
          ×©××•×¨ ×“×™×œ×•×’ âœ“
        </button>
      </form>
    </div>
    
    <!-- Screen 5: Add Actual Purchase (NEW!) -->
    <div class="screen" id="addPurchaseScreen">
      <div class="header">
        <button class="back-button" onclick="app.showScreen('homeScreen')">â†</button>
        <button class="home-button" onclick="app.showScreen('homeScreen')">ğŸ </button>
        <h1>×ª×¢×“ ×§× ×™×™×” ×‘×¤×•×¢×œ</h1>
        <p>××” ×§× ×™×ª ×”×™×•×?</p>
      </div>
      
      <div class="card" style="background: #FFF3E0; border-color: #FFB88C;">
        <p style="font-size: 14px; color: #757575; line-height: 1.6;">
          ğŸ“Œ <strong>×œ××” ×–×” ×—×©×•×‘?</strong><br>
          ×›×©××ª×” ××ª×¢×“ ×’× ××” ×©×§× ×™×ª ×‘×¤×•×¢×œ, ××ª×” ×™×›×•×œ ×œ×¨××•×ª ×”×× ×”×“×™×œ×•×’×™× ××©×¤×™×¢×™× ×¢×œ ×”×”×•×¦××•×ª ×©×œ×š ××• ×©××ª×” ×¤×©×•×˜ ×§×•× ×” ×“×‘×¨×™× ××—×¨×™× ×‘××§×•×.
        </p>
      </div>
      
      <form onsubmit="app.addPurchase(event)">
        <div class="form-group">
          <label>××” ×§× ×™×ª?</label>
          <input type="text" id="purchaseItem" placeholder='×œ××©×œ: "×¤×™×¦×”", "×—×•×œ×¦×”"' required>
        </div>
        
        <div class="form-group">
          <label>×›××” ×©×™×œ××ª?</label>
          <input type="number" id="purchaseAmount" placeholder="×¡×›×•× ×‘×©×´×—" min="0.01" step="0.01" required>
        </div>
        
        <div class="form-group">
          <label>×§×˜×’×•×¨×™×”</label>
          <select id="purchaseCategory" required>
            <option value="">×‘×—×¨ ×§×˜×’×•×¨×™×”</option>
            <option value="food">××•×›×œ ×•×©×ª×™×™×”</option>
            <option value="clothes">×‘×’×“×™×</option>
            <option value="entertainment">×‘×™×œ×•×™×™×</option>
            <option value="transport">×ª×—×‘×•×¨×”</option>
            <option value="tech">×˜×›× ×•×œ×•×’×™×”</option>
            <option value="other">××—×¨</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>×‘××™×–×• ×©×¢×”? (××•×¤×¦×™×•× ×œ×™)</label>
          <input type="time" id="purchaseTime">
        </div>
        
        <div class="form-group">
          <label>×”×¢×¨×•×ª (××•×¤×¦×™×•× ×œ×™)</label>
          <textarea id="purchaseNotes" rows="3" placeholder="×œ××” ×§× ×™×ª ××ª ×–×”?"></textarea>
        </div>
        
        <button type="submit" class="btn btn-primary">
          ×©××•×¨ ×§× ×™×™×” ğŸ›’
        </button>
      </form>
    </div>
    
    <!-- Screen 6: Investment Education -->
    <div class="screen" id="investmentScreen">
      <div class="header">
        <button class="back-button" onclick="app.showScreen('homeScreen')">â†</button>
        <button class="home-button" onclick="app.showScreen('homeScreen')">ğŸ </button>
        <h1>×œ××“ ×œ×”×©×§×™×¢</h1>
        <p>×—×™× ×•×š ×¤×™× × ×¡×™ ×‘×—×™× ×</p>
      </div>
      
      <h3 style="margin-bottom: 15px; font-size: 18px; color: #3D3D3D;">××§×•×¨×•×ª ××•××œ×¦×™×</h3>
      
      <div class="card" onclick="app.openLink('https://www.investopedia.com/terms/c/compoundinterest.asp')">
        <div class="card-header">
          <div>
            <div class="card-title">ğŸ“ˆ ×¨×™×‘×™×ª ×“×¨×™×‘×™×ª</div>
            <p style="font-size: 14px; color: #757575; margin-top: 5px;">×”×›×•×— ×©×œ ×—×™×¡×›×•×Ÿ ×œ×˜×•×•×— ××¨×•×š</p>
          </div>
          <div style="font-size: 24px;">â†’</div>
        </div>
      </div>
      
      <div class="card" onclick="app.openLink('https://www.investopedia.com/articles/personal-finance/040315/why-save-retirement-your-20s.asp')">
        <div class="card-header">
          <div>
            <div class="card-title">ğŸŒ± ×—×™×¡×›×•×Ÿ ××¦×¢×™×¨</div>
            <p style="font-size: 14px; color: #757575; margin-top: 5px;">×œ××” ×œ×”×ª×—×™×œ ××•×§×“×?</p>
          </div>
          <div style="font-size: 24px;">â†’</div>
        </div>
      </div>
      
      <div class="card" onclick="app.openLink('https://www.investopedia.com/investing/invest-101-what-are-stocks/')">
        <div class="card-header">
          <div>
            <div class="card-title">ğŸ“Š ××”×™ ×× ×™×”?</div>
            <p style="font-size: 14px; color: #757575; margin-top: 5px;">××‘×•× ×œ×”×©×§×¢×•×ª ×‘×©×•×§ ×”×”×•×Ÿ</p>
          </div>
          <div style="font-size: 24px;">â†’</div>
        </div>
      </div>
      
      <div class="card" onclick="app.openLink('https://www.investopedia.com/terms/b/bond.asp')">
        <div class="card-header">
          <div>
            <div class="card-title">ğŸ’¼ ××”×• ××’×´×—?</div>
            <p style="font-size: 14px; color: #757575; margin-top: 5px;">×”×©×§×¢×” ×‘×˜×•×—×” ×™×•×ª×¨</p>
          </div>
          <div style="font-size: 24px;">â†’</div>
        </div>
      </div>
      
      <div class="card" onclick="app.openLink('https://www.investopedia.com/investing/diversification-importance-investing/')">
        <div class="card-header">
          <div>
            <div class="card-title">ğŸ¯ ×¤×™×–×•×¨ ×¡×™×›×•× ×™×</div>
            <p style="font-size: 14px; color: #757575; margin-top: 5px;">××œ ×ª×©×™× ×”×›×œ ×‘×¡×œ ××—×“</p>
          </div>
          <div style="font-size: 24px;">â†’</div>
        </div>
      </div>
      
      <button class="btn btn-primary" onclick="app.showScreen('homeScreen')">
        ×—×–×¨×” ×œ×“×£ ×”×‘×™×ª
      </button>
    </div>
    
    <!-- Screen 7: History & Analytics -->
    <div class="screen" id="historyScreen">
      <div class="header">
        <button class="back-button" onclick="app.showScreen('homeScreen')">â†</button>
        <button class="home-button" onclick="app.showScreen('homeScreen')">ğŸ </button>
        <h1>×”×™×¡×˜×•×¨×™×” ×•××¢×§×‘</h1>
        <p>×”×“×™×œ×•×’×™× ×•×”×§× ×™×•×ª ×©×œ×š</p>
      </div>
      
      <!-- Today's Comparison -->
      <div class="comparison-card">
        <div class="comparison-title">ğŸ“… ×”×™×•×</div>
        <div class="comparison-row">
          <span class="comparison-label">×“×™×œ×’×ª×™ ×¢×œ:</span>
          <span class="comparison-value" id="todaySkips">â‚ª0</span>
        </div>
        <div class="comparison-row">
          <span class="comparison-label">×§× ×™×ª×™ ×‘×¤×•×¢×œ:</span>
          <span class="comparison-value" id="todayPurchases">â‚ª0</span>
        </div>
        <div class="comparison-footer" id="todayComparison">
          ××—×›×” ×œ× ×ª×•× ×™×...
        </div>
      </div>
      
      <!-- Tabs -->
      <div style="display: flex; gap: 10px; margin-bottom: 20px;">
        <button class="btn btn-secondary" style="flex: 1;" onclick="app.showHistoryTab('skips')">
          ğŸ’¸ ×“×™×œ×•×’×™×
        </button>
        <button class="btn btn-secondary" style="flex: 1;" onclick="app.showHistoryTab('purchases')">
          ğŸ›’ ×§× ×™×•×ª
        </button>
      </div>
      
      <!-- Skips List -->
      <div id="skipsTab">
        <h3 style="margin-bottom: 15px; font-size: 18px; color: #3D3D3D;">ğŸ“œ ×”×™×¡×˜×•×¨×™×™×ª ×“×™×œ×•×’×™×</h3>
        <div id="skipsList"></div>
      </div>
      
      <!-- Purchases List -->
      <div id="purchasesTab" style="display: none;">
        <h3 style="margin-bottom: 15px; font-size: 18px; color: #3D3D3D;">ğŸ“œ ×”×™×¡×˜×•×¨×™×™×ª ×§× ×™×•×ª</h3>
        <div id="purchasesList"></div>
      </div>
      
      <button class="btn btn-primary" onclick="app.showScreen('summaryScreen')">
        ğŸ“Š ×¡×™×›×•× ××œ×
      </button>
    </div>
    
    <!-- Screen 8: Summary -->
    <div class="screen" id="summaryScreen">
      <div class="header">
        <button class="back-button" onclick="app.showScreen('historyScreen')">â†</button>
        <button class="home-button" onclick="app.showScreen('homeScreen')">ğŸ </button>
        <h1>×¡×™×›×•× ××œ×</h1>
        <p>×”× ×ª×•× ×™× ×©×œ×š ×‘××‘×˜ ××—×“</p>
      </div>
      
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value" id="summaryTotalSkips">0</div>
          <div class="stat-label">×¡×”×´×› ×“×™×œ×•×’×™×</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="summaryTotalSavings">â‚ª0</div>
          <div class="stat-label">×¡×”×´×› ×—×¡×›×•×Ÿ</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="summaryTotalPoints">0</div>
          <div class="stat-label">×¡×”×´×› × ×§×•×“×•×ª</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="summaryAvgSkip">â‚ª0</div>
          <div class="stat-label">×××•×¦×¢ ×“×™×œ×•×’</div>
        </div>
      </div>
      
      <h3 style="margin: 20px 0 15px; font-size: 18px; color: #3D3D3D;">ğŸ“Š × ×™×ª×•×— ×”×ª× ×”×’×•×ª×™</h3>
      
      <div class="card">
        <div class="card-title">ğŸ’¸ ×¡×”×´×› ×“×™×œ×’×ª×™ ×¢×œ</div>
        <div class="card-amount" id="summarySkipsAmount">â‚ª0</div>
        <div class="card-details">
          <div class="card-detail">
            <span id="summarySkipsCount">0</span>
            <span>×“×™×œ×•×’×™×</span>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-title">ğŸ›’ ×¡×”×´×› ×§× ×™×ª×™ ×‘×¤×•×¢×œ</div>
        <div class="card-amount" style="color: #FF6B6B;" id="summaryPurchasesAmount">â‚ª0</div>
        <div class="card-details">
          <div class="card-detail">
            <span id="summaryPurchasesCount">0</span>
            <span>×§× ×™×•×ª</span>
          </div>
        </div>
      </div>
      
      <div class="comparison-card">
        <div class="comparison-title">ğŸ¯ ×”×× ×”×“×™×œ×•×’×™× ×¢×•×–×¨×™×?</div>
        <div id="behaviorAnalysis" style="font-size: 16px; line-height: 1.8;">
          ××—×›×” ×œ× ×ª×•× ×™×...
        </div>
      </div>
      
      <button class="btn btn-primary" onclick="app.showScreen('homeScreen')">
        ×—×–×¨×” ×œ×“×£ ×”×‘×™×ª
      </button>
    </div>
  </div>

  <script>
    // Firebase Configuration - REPLACE WITH YOUR CONFIG!
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY_HERE",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID",
      measurementId: "YOUR_MEASUREMENT_ID"
    };
    
    // Initialize Firebase
    let analytics = null;
    try {
      firebase.initializeApp(firebaseConfig);
      analytics = firebase.analytics();
      console.log('âœ… Firebase Analytics initialized');
    } catch (error) {
      console.warn('âš ï¸ Firebase not configured. Add your config to enable analytics.');
    }
    
    // App State
    const app = {
      currentScreen: 'welcomeScreen',
      language: 'he',
      user: {},
      skips: [],
      purchases: [],
      
      // Initialize
      init() {
        this.loadData();
        this.updateUI();
        this.trackPageView('welcome');
      },
      
      // Navigation
      showScreen(screenId) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(screenId).classList.add('active');
        this.currentScreen = screenId;
        this.trackPageView(screenId);
      },
      
      // Language
      setLanguage(lang) {
        this.language = lang;
        document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');
        this.trackEvent('language_selected', { language: lang });
      },
      
      // Registration
      register(e) {
        e.preventDefault();
        
        const name = document.getElementById('userName').value;
        const age = parseInt(document.getElementById('userAge').value);
        const gender = document.querySelector('input[name="gender"]:checked').value;
        const goal = document.getElementById('userGoal').value;
        
        this.user = {
          name,
          age,
          gender,
          goal,
          language: this.language,
          registeredAt: new Date().toISOString()
        };
        
        this.saveData();
        
        // Set user properties in Analytics
        if (analytics) {
          analytics.setUserProperties({
            age_group: this.getAgeGroup(age),
            gender: gender,
            language: this.language
          });
        }
        
        this.trackEvent('user_registered', {
          age,
          gender,
          language: this.language
        });
        
        document.getElementById('welcomeMessage').textContent = `×©×œ×•×, ${name}!`;
        this.showScreen('homeScreen');
      },
      
      // Add Skip
      addSkip(e) {
        e.preventDefault();
        
        const skip = {
          id: Date.now(),
          item: document.getElementById('skipItem').value,
          amount: parseFloat(document.getElementById('skipAmount').value),
          category: document.getElementById('skipCategory').value,
          notes: document.getElementById('skipNotes').value,
          points: parseFloat(document.getElementById('skipAmount').value) * 0.5,
          date: new Date().toISOString()
        };
        
        this.skips.push(skip);
        this.saveData();
        
        this.trackEvent('skip_added', {
          category: skip.category,
          amount: skip.amount,
          age: this.user.age,
          gender: this.user.gender
        });
        
        e.target.reset();
        alert(`×›×œ ×”×›×‘×•×“! ğŸ‰\n×“×™×œ×’×ª ×¢×œ ${skip.item}\n×§×™×‘×œ×ª ${skip.points} × ×§×•×“×•×ª!`);
        this.showScreen('investmentScreen');
      },
      
      // Add Purchase (NEW!)
      addPurchase(e) {
        e.preventDefault();
        
        const purchase = {
          id: Date.now(),
          item: document.getElementById('purchaseItem').value,
          amount: parseFloat(document.getElementById('purchaseAmount').value),
          category: document.getElementById('purchaseCategory').value,
          time: document.getElementById('purchaseTime').value,
          notes: document.getElementById('purchaseNotes').value,
          date: new Date().toISOString()
        };
        
        this.purchases.push(purchase);
        this.saveData();
        
        this.trackEvent('purchase_added', {
          category: purchase.category,
          amount: purchase.amount,
          age: this.user.age,
          gender: this.user.gender
        });
        
        e.target.reset();
        alert(`× ×¨×©×! ğŸ“\n×§× ×™×ª ${purchase.item} ×‘-${purchase.amount} ×©×´×—`);
        this.showScreen('historyScreen');
      },
      
      // History Tabs
      showHistoryTab(tab) {
        if (tab === 'skips') {
          document.getElementById('skipsTab').style.display = 'block';
          document.getElementById('purchasesTab').style.display = 'none';
        } else {
          document.getElementById('skipsTab').style.display = 'none';
          document.getElementById('purchasesTab').style.display = 'block';
        }
        
        this.updateHistoryUI();
      },
      
      // Update UI
      updateUI() {
        // Home stats
        const totalSkipsCount = this.skips.length;
        const totalSavings = this.skips.reduce((sum, s) => sum + s.amount, 0);
        const totalPoints = this.skips.reduce((sum, s) => sum + s.points, 0);
        const totalPurchasesCount = this.purchases.length;
        
        document.getElementById('totalSkips').textContent = totalSkipsCount;
        document.getElementById('totalSavings').textContent = `â‚ª${totalSavings.toFixed(0)}`;
        document.getElementById('totalPoints').textContent = totalPoints.toFixed(0);
        document.getElementById('totalPurchases').textContent = totalPurchasesCount;
        
        // Today's data
        const today = new Date().toDateString();
        const todaySkips = this.skips.filter(s => new Date(s.date).toDateString() === today);
        const todayPurchases = this.purchases.filter(p => new Date(p.date).toDateString() === today);
        
        const todaySkipsAmount = todaySkips.reduce((sum, s) => sum + s.amount, 0);
        const todayPurchasesAmount = todayPurchases.reduce((sum, p) => sum + p.amount, 0);
        
        document.getElementById('todaySkips').textContent = `â‚ª${todaySkipsAmount.toFixed(0)}`;
        document.getElementById('todayPurchases').textContent = `â‚ª${todayPurchasesAmount.toFixed(0)}`;
        
        const difference = todaySkipsAmount - todayPurchasesAmount;
        let comparisonText = '';
        if (difference > 0) {
          comparisonText = `âœ… ××¢×•×œ×”! ×—×¡×›×ª ${difference.toFixed(0)} ×©×´×— ×”×™×•×!`;
        } else if (difference < 0) {
          comparisonText = `âš ï¸ ×”×•×¦××ª ${Math.abs(difference).toFixed(0)} ×©×´×— ×™×•×ª×¨ ×××” ×©×“×™×œ×’×ª`;
        } else {
          comparisonText = `ğŸ¯ ××™×–×•×Ÿ ××•×©×œ×!`;
        }
        document.getElementById('todayComparison').textContent = comparisonText;
        
        // Summary stats
        document.getElementById('summaryTotalSkips').textContent = totalSkipsCount;
        document.getElementById('summaryTotalSavings').textContent = `â‚ª${totalSavings.toFixed(0)}`;
        document.getElementById('summaryTotalPoints').textContent = totalPoints.toFixed(0);
        document.getElementById('summaryAvgSkip').textContent = totalSkipsCount > 0 ? `â‚ª${(totalSavings / totalSkipsCount).toFixed(0)}` : 'â‚ª0';
        
        document.getElementById('summarySkipsAmount').textContent = `â‚ª${totalSavings.toFixed(0)}`;
        document.getElementById('summarySkipsCount').textContent = totalSkipsCount;
        
        const totalPurchasesAmount = this.purchases.reduce((sum, p) => sum + p.amount, 0);
        document.getElementById('summaryPurchasesAmount').textContent = `â‚ª${totalPurchasesAmount.toFixed(0)}`;
        document.getElementById('summaryPurchasesCount').textContent = totalPurchasesCount;
        
        // Behavior analysis
        let analysis = '';
        if (totalSkipsCount === 0 && totalPurchasesCount === 0) {
          analysis = '×”×ª×—×œ ×œ×ª×¢×“ ×“×™×œ×•×’×™× ×•×§× ×™×•×ª ×›×“×™ ×œ×¨××•×ª × ×™×ª×•×—!';
        } else if (totalSavings > totalPurchasesAmount) {
          const netSaving = totalSavings - totalPurchasesAmount;
          analysis = `ğŸ‰ ××¦×•×™×Ÿ! ×“×™×œ×’×ª ×¢×œ ${totalSavings.toFixed(0)} ×©×´×— ×•×§× ×™×ª ×¨×§ ${totalPurchasesAmount.toFixed(0)} ×©×´×—. ×—×™×¡×›×•×Ÿ × ×§×™: ${netSaving.toFixed(0)} ×©×´×—!`;
        } else if (totalSavings < totalPurchasesAmount) {
          analysis = `ğŸ¤” ×“×™×œ×’×ª ×¢×œ ${totalSavings.toFixed(0)} ×©×´×— ××‘×œ ×§× ×™×ª ${totalPurchasesAmount.toFixed(0)} ×©×´×—. × ×¡×” ×œ×“×œ×’ ×¢×œ ×™×•×ª×¨ ×“×‘×¨×™× ××• ×œ×”×¤×—×™×ª ×§× ×™×•×ª!`;
        } else {
          analysis = `âš–ï¸ ××™×–×•×Ÿ ××•×©×œ×! ×“×™×œ×’×ª ×•×§× ×™×ª ×‘×¡×›×•××™× ×“×•××™×.`;
        }
        document.getElementById('behaviorAnalysis').innerHTML = analysis;
        
        this.updateHistoryUI();
      },
      
      // Update History UI
      updateHistoryUI() {
        // Skips list
        const skipsList = document.getElementById('skipsList');
        if (this.skips.length === 0) {
          skipsList.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ğŸ“­</div><p>×¢×“×™×™×Ÿ ×œ× ×“×™×œ×’×ª ×¢×œ ×›×œ×•×<br>×”×ª×—×œ ×¢×›×©×™×•!</p></div>';
        } else {
          const sortedSkips = [...this.skips].reverse();
          skipsList.innerHTML = sortedSkips.map(skip => `
            <div class="purchase-item">
              <div class="purchase-info">
                <div class="purchase-name">${skip.item}</div>
                <div class="purchase-time">${new Date(skip.date).toLocaleDateString('he-IL')} | ${skip.category}</div>
              </div>
              <div class="purchase-amount" style="color: #7EBA9B;">â‚ª${skip.amount.toFixed(0)}</div>
            </div>
          `).join('');
        }
        
        // Purchases list
        const purchasesList = document.getElementById('purchasesList');
        if (this.purchases.length === 0) {
          purchasesList.innerHTML = '<div class="empty-state"><div class="empty-state-icon">ğŸ›’</div><p>×¢×“×™×™×Ÿ ×œ× ×ª×™×¢×“×ª ×§× ×™×•×ª<br>×”×ª×—×œ ×œ×¢×§×•×‘!</p></div>';
        } else {
          const sortedPurchases = [...this.purchases].reverse();
          purchasesList.innerHTML = sortedPurchases.map(purchase => `
            <div class="purchase-item">
              <div class="purchase-info">
                <div class="purchase-name">${purchase.item}</div>
                <div class="purchase-time">${new Date(purchase.date).toLocaleDateString('he-IL')} ${purchase.time ? `| ${purchase.time}` : ''} | ${purchase.category}</div>
              </div>
              <div class="purchase-amount">â‚ª${purchase.amount.toFixed(0)}</div>
            </div>
          `).join('');
        }
      },
      
      // Open Link
      openLink(url) {
        this.trackEvent('investment_link_clicked', { url });
        window.open(url, '_blank');
      },
      
      // Analytics Tracking
      trackPageView(screenName) {
        if (analytics) {
          analytics.logEvent('screen_view', {
            screen_name: screenName,
            app_version: '5.0'
          });
        }
        console.log('ğŸ“Š Page view:', screenName);
      },
      
      trackEvent(eventName, params = {}) {
        if (analytics) {
          analytics.logEvent(eventName, {
            ...params,
            timestamp: new Date().toISOString()
          });
        }
        console.log('ğŸ“Š Event:', eventName, params);
      },
      
      // Helper: Age Group
      getAgeGroup(age) {
        if (age < 18) return '13-17';
        if (age < 25) return '18-24';
        if (age < 35) return '25-34';
        if (age < 45) return '35-44';
        if (age < 55) return '45-54';
        return '55+';
      },
      
      // Storage
      saveData() {
        localStorage.setItem('skipapp_user', JSON.stringify(this.user));
        localStorage.setItem('skipapp_skips', JSON.stringify(this.skips));
        localStorage.setItem('skipapp_purchases', JSON.stringify(this.purchases));
        this.updateUI();
      },
      
      loadData() {
        const user = localStorage.getItem('skipapp_user');
        const skips = localStorage.getItem('skipapp_skips');
        const purchases = localStorage.getItem('skipapp_purchases');
        
        if (user) {
          this.user = JSON.parse(user);
          document.getElementById('welcomeMessage').textContent = `×©×œ×•×, ${this.user.name}!`;
          this.showScreen('homeScreen');
        }
        
        if (skips) this.skips = JSON.parse(skips);
        if (purchases) this.purchases = JSON.parse(purchases);
      }
    };
    
    // Initialize app
    window.addEventListener('DOMContentLoaded', () => {
      app.init();
      
      // Register Service Worker
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker
          .register('/service-worker.js')
          .then((registration) => {
            console.log('âœ… Service Worker registered:', registration.scope);
          })
          .catch((error) => {
            console.warn('âš ï¸ Service Worker registration failed:', error);
          });
      }
    });
  </script>
</body>
</html>
